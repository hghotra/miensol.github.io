{"componentChunkName":"component---src-templates-post-template-tsx","path":"/guide-to-javascript-generators/","result":{"data":{"markdownRemark":{"id":"dc0a3088-827f-59b4-8e69-66c3f452865a","html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 400px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 66.66666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAIEBf/EABUBAQEAAAAAAAAAAAAAAAAAAAEC/9oADAMBAAIQAxAAAAGpIK0YwSH/xAAZEAADAQEBAAAAAAAAAAAAAAABAgMRBBL/2gAIAQEAAQUC9lJyrSlK9RR5sQ6oFm27/8QAFREBAQAAAAAAAAAAAAAAAAAAEDH/2gAIAQMBAT8Bh//EABYRAAMAAAAAAAAAAAAAAAAAABAREv/aAAgBAgEBPwF0P//EAB0QAAIBBAMAAAAAAAAAAAAAAAABEQISITEiUaH/2gAIAQEABj8CbpUsS4xtkL1C6KrcZNn/xAAZEAADAQEBAAAAAAAAAAAAAAAAAREhMUH/2gAIAQEAAT8hamEbGZhxgvBhXiDcK2QoJ03Bq1mf/9oADAMBAAIAAwAAABCg7//EABYRAQEBAAAAAAAAAAAAAAAAAAEQEf/aAAgBAwEBPxAQ4z//xAAYEQACAwAAAAAAAAAAAAAAAAAAASExUf/aAAgBAgEBPxBWInT/xAAcEAEAAgMAAwAAAAAAAAAAAAABABEhMUFRcdH/2gAIAQEAAT8QPK+W0nddqBCzYfHG3bDHaHA38jOJNmw1o222DQeiZlPln//Z'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n        <source\n          srcset=\"/static/df05605e171e3486f08fe325ae73d512/8ac56/yield-sign.webp 240w,\n/static/df05605e171e3486f08fe325ae73d512/7f61c/yield-sign.webp 400w\"\n          sizes=\"(max-width: 400px) 100vw, 400px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/df05605e171e3486f08fe325ae73d512/09b79/yield-sign.jpg 240w,\n/static/df05605e171e3486f08fe325ae73d512/066f9/yield-sign.jpg 400w\"\n          sizes=\"(max-width: 400px) 100vw, 400px\"\n          type=\"image/jpeg\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          src=\"/static/df05605e171e3486f08fe325ae73d512/066f9/yield-sign.jpg\"\n          alt=\"Yield sign\"\n          title=\"Yield sign\"\n          loading=\"lazy\"\n          style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        />\n      </picture>\n    </span>\nFor a while now I’ve been hearing and reading about a new exciting features of ES6 like arrow functions, array comprehensions, classes, modules, generators and many more. While many of them are easy to understand <a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/function*\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">generators</a> can take a while to grok. So I thought it would be a good idea to write some samples to master this particular feature.</p>\n<h2 id=\"what-are-generators\" style=\"position:relative;\"><a href=\"#what-are-generators\" aria-label=\"what are generators permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>What are generators</h2>\n<p>Generators or to be more precise <em>generator functions</em> are functions which can be exited and then reentered with function execution context (variable binding) preserved - a limited version of <a href=\"http://en.wikipedia.org/wiki/Coroutine\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">coroutines</a> if you will. Traditionally they are used to write iterators more easily but of course they have many more interesting use cases.</p>\n<p><em>To run following samples your <code class=\"language-text\">node</code> version has to support harmony generators. You can check that with <code class=\"language-text\">node --v8-options | grep harmony</code>. The latest unstable version 0.11.12 supports them.</em></p>\n<h3 id=\"a-simple-generator\" style=\"position:relative;\"><a href=\"#a-simple-generator\" aria-label=\"a simple generator permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>A simple generator</h3>\n<p>Here’s a very simple example of generator that yields only two values:\n{% gist miensol/9cf18bc90b2021018403 %}\nwhen executed it will output:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token punctuation\">{</span>value: <span class=\"token number\">1</span>, done: false<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">{</span>value: <span class=\"token number\">2</span>, done: false<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">{</span>value: undefined, done: true<span class=\"token punctuation\">}</span></code></pre></div>\n<h3 id=\"a-fibonacci-generator\" style=\"position:relative;\"><a href=\"#a-fibonacci-generator\" aria-label=\"a fibonacci generator permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>A Fibonacci generator</h3>\n<p>Of course since we have an easy way to create iterators we have to have a way to iterate over them. One approach is to just use a while loop:\n{% gist miensol/367d27fb1b3f7966e31a %}</p>\n<p>but honestly this would be a step back. Fortunately es6 comes with a new kind of <code class=\"language-text\">for-of</code> loop designed specifically to work with iterators:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> current <span class=\"token keyword\">of</span> <span class=\"token function\">fibo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>current<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3 id=\"iterators-and-iterables\" style=\"position:relative;\"><a href=\"#iterators-and-iterables\" aria-label=\"iterators and iterables permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Iterators and iterables</h3>\n<p>I’ve mentioned couple of times a word iterator, but what exactly is that? In ES6 iterator is an object that has <code class=\"language-text\">next</code> method which when called returns and object having 2 properties:</p>\n<ul>\n<li><code class=\"language-text\">value</code> - which represents value returned by iterator</li>\n<li><code class=\"language-text\">done</code> - a boolean indicating whether iterator has done it’s job or not</li>\n</ul>\n<p>As we saw in the above generator examples every generator is an implicit iterator thus we can loop through it using new <code class=\"language-text\">for-of</code> syntax.</p>\n<p>There is one more object <em>type</em> it is good to know of - <code class=\"language-text\">iterable</code>. According to <a href=\"http://wiki.ecmascript.org/doku.php?id=harmony:iterators\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">ES6 Wiki</a> an object is iterable if has a internal property named <code class=\"language-text\">iterator</code> which is a function returning iterator. Unfortunatelly the latests specs aren’t yet implemented in v8 (or incorporated in node.js) so the following example is only my understanding of the specs:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> iterable <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\niterable<span class=\"token punctuation\">[</span>Symbol<span class=\"token punctuation\">.</span>iterator<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'calling Symbol.iterator'</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">yield</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">yield</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> item <span class=\"token keyword\">of</span> iterable<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>item<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>which would print:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">calling Symbol.iterator\n<span class=\"token number\">1</span>\n<span class=\"token number\">2</span></code></pre></div>\n<h2 id=\"passing-values-to-generators\" style=\"position:relative;\"><a href=\"#passing-values-to-generators\" aria-label=\"passing values to generators permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Passing values to generators</h2>\n<p>So far we’ve covered the most simplistic usage of generators for those familiar with .NET it reassembles a <code class=\"language-text\">yield</code> keyword introduced in C# 2.0 in 2005. Since ES6 Generators design was influenced a lot by python generators now wonder we can also pass values to generator functions. You do it by passing value to <code class=\"language-text\">next</code> function call:\n{% gist miensol/30aa3afe5396bdc6b8c1 %}</p>\n<p>Running it should output something similar to:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">How old are you? oracle says:  <span class=\"token number\">0.760754773626104</span>\nWhy? oracle says:  <span class=\"token number\">0.36784305213950574</span>\nThank you<span class=\"token operator\">!</span></code></pre></div>\n<p>A careful reader will notice that the first question is silently ignored by our <em>oracle</em> generator. This is logical although might be strange at first. The generator function body isn’t executed until we call <code class=\"language-text\">next</code> for the <strong>first time</strong> - which is like <em>starting</em> the generator. The call to <code class=\"language-text\">next</code> will execute function body until it encounters <code class=\"language-text\">yield</code> - the control flow changes and the function is left to be entered later on - on future <code class=\"language-text\">next</code> call. Notice that we there is no logical place to store/assign the value passed to first <code class=\"language-text\">next()</code> call - <strong>a value that we pass to first <code class=\"language-text\">next()</code> call is ignored.</strong></p>\n<p><em>Thanks to <a href=\"http://notherdev.blogspot.com/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">@NOtherDev</a> for pointing that out</em>.</p>\n<h3 id=\"generators-error-handling\" style=\"position:relative;\"><a href=\"#generators-error-handling\" aria-label=\"generators error handling permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Generators error handling</h3>\n<p>Now that we know how to yield values and receive them inside generators. It’s equally important to be able to handle exceptions gracefully. Since generators are executing synchronously semantics of typical <code class=\"language-text\">try {} catch {}</code> should be preseved:\n{% gist miensol/f740e31ccc73283809a5 %}\nwhich would output:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">Generator entered, yielding first value\nGenerator asked <span class=\"token keyword\">for</span> second value - will go bum\n<span class=\"token punctuation\">[</span>Error: You can only call this generator once, sorry<span class=\"token operator\">!</span><span class=\"token punctuation\">]</span></code></pre></div>\n<p>It’s important to note however that if you try to call <code class=\"language-text\">next</code> method on a generator that has thrown an exception you’ll get another error:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">throwingGenerator.next<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                  ^\nError: Generator is already running\n    at GeneratorFunctionPrototype.next <span class=\"token punctuation\">(</span>native<span class=\"token punctuation\">)</span></code></pre></div>\n<p>Now this was a case when a generator has thrown exception at caller. What if we would like to tell generator that an error occured at caller’s site. Thanks to generator <code class=\"language-text\">throw</code> function that is easy enough:</p>\n<p>{% gist miensol/d5dd0e6d46c05f51f0ed %}</p>\n<p>This as you may expect will produce:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">I will stop when you tell me about error\nGot value from you: I will throw <span class=\"token keyword\">in</span> a moment<span class=\"token operator\">!</span>\nGot error from you: This is the end. Goodbye<span class=\"token operator\">!</span></code></pre></div>\n<h2 id=\"practical-generator-usage\" style=\"position:relative;\"><a href=\"#practical-generator-usage\" aria-label=\"practical generator usage permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Practical generator usage</h2>\n<p>An obvious use case is of course creating lazy evaluated collections. One can now very easily implement collection operators that are available in LINQ. Consider following examples:\n{% gist miensol/e5c8f929e2fcdf0253b2 %}\nwhich when executed will output <em>(note the order or DEBUG calls)</em>:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">DEBUG: concat yielding first generator values\nDEBUG: reverse will yield <span class=\"token number\">6</span>\nDEBUG: filter predicate value <span class=\"token boolean\">true</span> <span class=\"token keyword\">for</span> item <span class=\"token number\">6</span>\nDEBUG: take will yield  <span class=\"token number\">6</span> counter <span class=\"token number\">1</span>\nDEBUG: <span class=\"token keyword\">select</span> will yield Even number <span class=\"token number\">6</span>\nEven number <span class=\"token number\">6</span>\nDEBUG: reverse will yield <span class=\"token number\">5</span>\nDEBUG: filter predicate value <span class=\"token boolean\">false</span> <span class=\"token keyword\">for</span> item <span class=\"token number\">5</span>\nDEBUG: reverse will yield <span class=\"token number\">4</span>\nDEBUG: filter predicate value <span class=\"token boolean\">true</span> <span class=\"token keyword\">for</span> item <span class=\"token number\">4</span>\nDEBUG: take will yield  <span class=\"token number\">4</span> counter <span class=\"token number\">2</span>\nDEBUG: <span class=\"token keyword\">select</span> will yield Even number <span class=\"token number\">4</span>\nEven number <span class=\"token number\">4</span>\nDEBUG: concat yielding second generator values\nAt the end</code></pre></div>\n<p>Note the <code class=\"language-text\">concat</code> function implementation uses <code class=\"language-text\">yield *otherGenerator()</code> to yield values yielded by other generator which greatly reduces a boilerplate code needed otherwise.</p>\n<h3 id=\"simplifying-asynchronous-operations\" style=\"position:relative;\"><a href=\"#simplifying-asynchronous-operations\" aria-label=\"simplifying asynchronous operations permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Simplifying asynchronous operations</h3>\n<p>It may as first be a surprise that generators can streamline asynchronous code - how would synchronously executing <code class=\"language-text\">yield</code> help in managing asynchronous calls? If you think of the way we write asynchronous code in most of mainstream languages it typically boils down to either:</p>\n<ul>\n<li>passing a callback function(s) that will be called when the operation completes</li>\n<li>immediately getting back a promise of result from async function</li>\n<li>using a library similar to <a href=\"http://msdn.microsoft.com/pl-pl/data/gg577609.aspx\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Reactive Extensions</a> - that when it comes to asynchronous code somewhat similar in usage to promises but offers very rich API</li>\n</ul>\n<p>Now when you look at async code consuming:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> <span class=\"token function-variable function\">power</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">number<span class=\"token punctuation\">,</span> exponent</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> deferred <span class=\"token operator\">=</span> <span class=\"token constant\">Q</span><span class=\"token punctuation\">.</span><span class=\"token function\">defer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    deferred<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">pow</span><span class=\"token punctuation\">(</span>number<span class=\"token punctuation\">,</span> exponent<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">300</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> deferred<span class=\"token punctuation\">.</span>promise<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">power</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">result</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>I immediately translate promise calls in my head to a more natural flow:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> result <span class=\"token operator\">=</span> _wait_for_async_ <span class=\"token function\">power</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Now since we don’t have <code class=\"language-text\">async</code> feature like the one C# 5 has (<a href=\"http://wiki.ecmascript.org/doku.php?id=strawman:async_functions\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">or rather we don’t yet have it</a>) it’s not yet possible to achieve this kind of simplification. Still if you think of how the <em>imaginary</em> <code class=\"language-text\">_wait_for_async_</code> keyword would work it seems that it (in case of promise based implememntation):</p>\n<ul>\n<li>would wait for the promise to complete in a non blocking fashion - possibly leaving function execution context</li>\n<li>when the promise completes it would return to the exact place from where it was <em>called</em> and return value that it got from promise or throw an exception</li>\n</ul>\n<p>Essentially that’s the way <code class=\"language-text\">yield</code> keyword works - however we still need an umbrella machinery that will  take care of calling generator <code class=\"language-text\">next</code> method so it will return to the original caller as well as it <code class=\"language-text\">throw</code> method to report exceptions.</p>\n<p>As you may have guessed there are already plenty of implementations of this machinery - the one I like most is <a href=\"https://github.com/visionmedia/co\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">co</a>. Take a look at an example from their page and enjoy callback free life!</p>","fields":{"slug":"/guide-to-javascript-generators/","tagSlugs":["/tag/javascript/","/tag/nodejs/","/tag/es-6/","/tag/generators/"]},"excerpt":"For a while now I’ve been hearing and reading about a new exciting features of ES6 like arrow functions, array comprehensions, classes, modules, generators and many more. While many of them are easy to understand generators can take a while to grok. So I thought it would be a good idea to write some samples to master…","frontmatter":{"date":"2014-06-15T00:00:00.000Z","description":null,"tags":["javascript","nodejs","ES6","generators"],"title":"Guide to javascript generators","socialImage":null}}},"pageContext":{"slug":"/guide-to-javascript-generators/"}}}